import{a as x,j as e,s as y,o as b,p as j,t as P,F as d,f as E,q as C}from"./vendor-font-awesome-fb8PRCmj.js";import{u as v,C as U,l as A,d as S,E as k,f as I,e as q}from"./index-lBioDFl4.js";import{B as u}from"./Button-C3YJ6iVm.js";import{u as N}from"./useDocumentTitle-CWGRdlYI.js";import{u as F,a as R,o as T,s as c,e as B}from"./vendor-forms-CXz_4OM6.js";import{I as i}from"./InputField-B-7MhsdR.js";import{a as L}from"./vendor-states-CBI6bQG0.js";import{y as M}from"./index-CcAK1yoR.js";import V from"./EmailConfirmation-BOPdBHhA.js";import{P as D}from"./PageHeader-1TgteFVd.js";import{u as H}from"./usePageLog-CpyrOzkW.js";import{b as K}from"./vendor-react-Cx4ePrNi.js";import{A as $}from"./errors-DgiVCGd9.js";import"./appMeta-B1yHDSiB.js";import"./InputLabel-DqjUQIAl.js";import"./InputIcon-B7ia0x9Z.js";import"./404-DFHyxhtu.js";const z=T({username:c().min(3,{message:"Username must be at least 3 characters long"}).max(20,{message:"Username must be no longer than 20 characters"}).min(1,{message:"Username is required"}),email:B({message:"Invalid email address"}).min(1,{message:"Email is required"}),password:c().min(6,{message:"Password must be at least 6 characters long"}).max(20,{message:"Password must be no longer than 20 characters"}).min(1,{message:"Password is required"}),confirmPassword:c().min(6,{message:"Password must be at least 6 characters long"}).max(20,{message:"Password must be no longer than 20 characters"}).min(1,{message:"Confirm Password is required"})}).superRefine(({confirmPassword:t,password:m},n)=>{t!==m&&n.addIssue({code:"custom",message:"The passwords did not match",path:["confirmPassword"]})}),ne=()=>{const t=K(),{signUp:m}=v(),[n,f]=x.useState(!1),{getValues:p,register:r,formState:{isValid:g,errors:o},setError:l,handleSubmit:w}=F({resolver:R(z),mode:"onChange"});N("Register"),H("Register");const{mutateAsync:h,isPending:a}=L({mutationFn:async s=>await m(s.username,s.email,s.password),onError:s=>{S(k.registrationError,s),s instanceof $?l("email",{type:"custom",message:s.message}):s instanceof I?(s.emailUnavailable&&l("email",{type:"custom",message:"This email is already in use."}),s.usernameUnavailable&&l("username",{type:"custom",message:"This username is already taken."})):M.error("An unexpected error occurred. Please try again later.")},onSuccess:()=>{A(q.signUp),f(!0)}});return n?e.jsx(V,{message:`Please check your inbox (${p("email")}) 
            and confirm your email address to complete the registration process. 
            If you haven't received the email, check your spam folder or 
            request a new one.`}):e.jsxs("div",{className:"w-full min-h-screen flex flex-col items-center justify-center my-8",children:[e.jsx(D,{title:"Create Account",subtitle:"Sign up to start your journey"}),e.jsx("form",{className:"w-full max-w-md",onSubmit:w(async s=>await h(s)),noValidate:!0,children:e.jsxs(U,{className:"w-full space-y-6",children:[e.jsx(i,{disabled:a,icon:y,label:"Username",id:"username",register:r,error:o.username}),e.jsx(i,{disabled:a,icon:b,label:"Email",id:"email",type:"email",register:r,error:o.email}),e.jsx(i,{disabled:a,icon:j,label:"Password",id:"password",type:"password",register:r,error:o.password}),e.jsx(i,{disabled:a,icon:P,label:"Confirm password",id:"confirmPassword",type:"password",register:r,error:o.confirmPassword}),e.jsx(u,{disabled:!g||a,className:"w-full",type:"submit",children:a?e.jsx(d,{icon:E,spin:!0}):"Sign Up"})]})}),e.jsxs(u,{variant:"link",className:"w-full max-w-md flex justify-center items-center mt-4 gap-2",onClick:()=>{window.scrollTo(0,0),t("/")},children:[e.jsx(d,{icon:C}),"Back to main page"]})]})};export{ne as default};
