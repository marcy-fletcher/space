const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Comments-x78SD8ih.js","assets/vendor-font-awesome-fb8PRCmj.js","assets/index-DVJIb8Cr.js","assets/vendor-react-Cx4ePrNi.js","assets/vendor-states-BrjWHaJB.js","assets/index-COJnJjyW.css","assets/InputArea-DPhGCaWx.js","assets/InputLabel-DfrZCBfn.js","assets/Button-85dFU1bc.js","assets/Badge-KlCDyamb.js","assets/formatDate-HarhDgxf.js","assets/vendor-forms-CXz_4OM6.js","assets/index-BpgUN2na.js","assets/posts.service-BP_r8Hbi.js","assets/Subtitle-BGRHiaIL.js","assets/Divider-CC-zyncc.js","assets/capitalizeWords-BTXM6-FP.js","assets/useDocumentTitle-1xR-jf3b.js","assets/RequirePolicy-CTpCXijE.js","assets/ExternalLinkButton-67Fwm6ir.js","assets/FoldoutIcon-C72KZmKq.js","assets/subscription-iDNfJ_xm.js","assets/usePageLog-Cwne7LeP.js","assets/ReactionSection-4EO1IM8U.js","assets/Markdown-3h1heg92.js"])))=>i.map(i=>d[i]);
import{C as g,c as p,H as m,q as U,p as L,r as z,b as F,d as B,E as D,_ as k}from"./index-DVJIb8Cr.js";import{j as e,a as c,F as d,f as v,s as O,z as H,A as M,B as V,p as $,C as W,h as K,D as Q,E as y}from"./vendor-font-awesome-fb8PRCmj.js";import{p as G,h as Y,b as J,i as X,c as Z}from"./posts.service-BP_r8Hbi.js";import{S as w}from"./Subtitle-BGRHiaIL.js";import{D as S}from"./Divider-CC-zyncc.js";import{a as q,u as ee}from"./vendor-states-BrjWHaJB.js";import{f as P}from"./formatDate-HarhDgxf.js";import{c as N,T as se}from"./capitalizeWords-BTXM6-FP.js";import{u as re}from"./useDocumentTitle-1xR-jf3b.js";import{U as ae,R as te}from"./RequirePolicy-CTpCXijE.js";import{B as u}from"./Button-85dFU1bc.js";import{y as h}from"./index-BpgUN2na.js";import{b as C,L as R,e as ne}from"./vendor-react-Cx4ePrNi.js";import{E as f}from"./ExternalLinkButton-67Fwm6ir.js";import{F as ie}from"./FoldoutIcon-C72KZmKq.js";import{B as b}from"./Badge-KlCDyamb.js";import{g as E}from"./subscription-iDNfJ_xm.js";import{u as oe}from"./usePageLog-Cwne7LeP.js";const A=()=>e.jsxs("div",{className:"flex flex-wrap gap-2 justify-center my-6",children:[e.jsx("div",{className:"w-20 h-10 bg-mono-200 dark:bg-mono-700 rounded-3xl"}),e.jsx("div",{className:"w-20 h-10 bg-mono-200 dark:bg-mono-700 rounded-3xl"}),e.jsx("div",{className:"w-20 h-10 bg-mono-200 dark:bg-mono-700 rounded-3xl"}),e.jsx("div",{className:"w-20 h-10 bg-mono-200 dark:bg-mono-700 rounded-3xl"})]}),le=()=>e.jsxs("div",{className:"my-4 text-mono-700 dark:text-mono-300 leading-relaxed text-justify text-lg",children:[e.jsx("div",{className:"h-6 bg-mono-200 dark:bg-mono-700 rounded-3xl mb-3"}),e.jsx("div",{className:"h-6 bg-mono-200 dark:bg-mono-700 rounded-3xl mb-3"}),e.jsx("div",{className:"h-6 bg-mono-200 dark:bg-mono-700 rounded-3xl mb-3"}),e.jsx("div",{className:"h-6 bg-mono-200 dark:bg-mono-700 rounded-3xl mb-3"})]}),ce=()=>e.jsx("div",{className:"container mx-auto px-4 max-w-4xl min-h-screen",children:e.jsxs(g,{className:"p-8 md:p-12 mt-4 animate-pulse",children:[e.jsx("div",{className:"h-12 w-3/4 bg-mono-200 dark:bg-mono-700 rounded-3xl mb-4"}),e.jsx("div",{className:"h-6 w-1/4 bg-mono-200 dark:bg-mono-700 rounded-3xl mb-4"}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsx("div",{className:"h-8 w-24 bg-mono-200 dark:bg-mono-700 rounded-full"}),e.jsx("div",{className:"h-8 w-24 bg-mono-200 dark:bg-mono-700 rounded-full"})]}),e.jsx(A,{}),e.jsx("div",{className:"h-px bg-mono-300 dark:bg-mono-600 my-6"}),e.jsx(le,{})]})});function de(a){if(a)return{id:isNaN(Number(a))?void 0:Number(a),slug:isNaN(Number(a))?a:void 0}}const me=({post:a})=>{const i=C(),[r,l]=c.useState(a.isPublished),[o,n]=c.useState(!1),[s,t]=c.useState(!1);async function x(){try{n(!0),await G(a.id),h.success("Post has been published successfully!"),l(!0)}catch{h.error("There was an issue while publishing post. Please try again.")}finally{n(!1)}}async function I(){try{t(!0),await Y(a.id),h.success("Post has been hidden successfully!"),l(!1)}catch{h.error("There was an issue while hiding post. Please try again.")}finally{t(!1)}}return e.jsxs(g,{className:"flex flex-col sm:flex-row gap-2 p-2 justify-between",children:[e.jsxs("div",{className:"flex gap-2 flex-col sm:flex-row",children:[!r&&e.jsxs(u,{disabled:o,onClick:x,size:"small",shape:"square",variant:"submit",className:"min-w-30 flex items-center justify-center",children:[!o&&e.jsx(e.Fragment,{children:"Publish"}),o&&e.jsx(d,{icon:v,spin:!0})]}),r&&e.jsxs(u,{disabled:s,onClick:I,size:"small",shape:"square",variant:"outline",className:"min-w-30 flex items-center justify-center",children:[!s&&e.jsx(e.Fragment,{children:"Hide"}),s&&e.jsx(d,{icon:v,spin:!0})]}),e.jsx(u,{onClick:()=>i(`/posts/edit/${a.id}`),size:"small",shape:"square",variant:"secondary",className:"min-w-30 flex items-center justify-center",children:"Edit"})]}),e.jsx(S,{className:"sm:hidden my-2"}),e.jsx(u,{size:"small",shape:"square",variant:"danger",className:"min-w-30",children:"Delete"})]})},j=({className:a,children:i,title:r,defaultOpen:l=!1})=>{const[o,n]=c.useState(l),s=()=>n(!o);return e.jsxs("div",{className:p("bg-white dark:bg-mono-800 rounded-2xl shadow-lg border border-mono-200 dark:border-mono-700 p-4",a),children:[e.jsxs("div",{onClick:s,className:"cursor-pointer flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:r}),e.jsx(ie,{isOpen:o})]}),o&&e.jsx("div",{children:i})]})},xe=({references:a,className:i})=>{const r=a.filter(s=>s.type==="person"),l=a.filter(s=>s.type==="event"),o=a.filter(s=>s.type==="franchise"),n=a.filter(s=>s.type==="other");return e.jsxs("div",{className:p("flex flex-col gap-4",i),children:[e.jsx(m,{children:"Story References"}),r&&r.length>0&&e.jsx(j,{title:"People",className:"flex flex-col gap-5",children:e.jsx("div",{className:"grid grid-cols-1 xs:grid-cols-2 sm:grid-cols-3 gap-4",children:r.map((s,t)=>e.jsx(f,{isClickable:!!s?.url,actionType:s.url?"open":"none",title:s.name,subtitle:s.description,content:s.url,image:s.pictureUrl,icon:O,variant:"gray"},t))})}),l&&l.length>0&&e.jsx(j,{title:"Events",className:"flex flex-col gap-5",children:e.jsx("div",{className:"grid grid-cols-1 xs:grid-cols-2 sm:grid-cols-3 gap-4",children:l.map((s,t)=>e.jsx(f,{isClickable:!!s?.url,actionType:s.url?"open":"none",title:s.name,subtitle:s.description,content:s.url,image:s.pictureUrl,icon:H,variant:"gray"},t))})}),o&&o.length>0&&e.jsx(j,{title:"Franchises",className:"flex flex-col gap-5",children:e.jsx("div",{className:"grid grid-cols-1 xs:grid-cols-2 sm:grid-cols-3 gap-4",children:o.map((s,t)=>e.jsx(f,{isClickable:!!s?.url,actionType:s.url?"open":"none",title:s.name,subtitle:s.description,content:s.url,image:s.pictureUrl,icon:M,variant:"gray"},t))})}),n&&n.length>0&&e.jsx(j,{title:"Other",className:"flex flex-col gap-5",children:e.jsx("div",{className:"grid grid-cols-1 xs:grid-cols-2 sm:grid-cols-3 gap-4",children:n.map((s,t)=>e.jsx(f,{isClickable:!!s?.url,actionType:s.url?"open":"none",title:s.name,subtitle:s.description,content:s.url,image:s.pictureUrl,icon:V,variant:"gray"},t))})})]})},ue=()=>e.jsx("div",{className:"bg-mono-200 dark:bg-mono-700 p-4 rounded-xl animate-pulse grow min-h-20"});function T(a,i){return a.length>i?a.slice(0,i-3)+"...":a}const ge=({relatedPost:a})=>e.jsxs(g,{className:"flex flex-col gap-4",children:[e.jsx(R,{to:`/posts/${a.slug}`,children:e.jsxs("div",{className:"flex flex-row gap-4 items-center",children:[e.jsx(ae,{className:"min-w-10 min-h-10 w-10 h-10",source:a.pictureUrl,alt:"Related post preview"}),a.title&&e.jsx(m,{children:T(a.title,30)})]})}),a.summary&&e.jsx("p",{className:"text-sm text-mono-500",children:T(a.summary,100)}),e.jsx("div",{className:"grow"}),e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsx("span",{className:"text-sm text-mono-500",children:P(a.createdAt)}),e.jsx(R,{to:`/posts/${a.slug}`,className:"text-sm text-primary-500",children:"Open"})]})]}),pe=a=>a==="green"?"hover:border-green-600 hover:dark:border-green-600 bg-gradient-to-br from-green-200 to-green-100 dark:from-green-900 dark:to-mono-800":"hover:border-primary-600 hover:dark:border-primary-600 bg-gradient-to-br from-primary-100/30 to-primary-200/30 dark:from-primary-900/30 dark:to-mono-900/50",he=({relatedPost:a})=>{const[i,r]=c.useState(!1),l=C(),o=a.requiredRoles?.map(s=>({role:s,rank:E(s)?.rank??-1})).sort((s,t)=>t.rank-s.rank)[0]?.role??"guest",n=o==="acolyte";return e.jsxs(g,{className:p("flex flex-col gap-4",pe(n?"green":"primary")),children:[e.jsxs("div",{className:"flex flex-row gap-4 items-center",children:[e.jsx("div",{className:p("flex min-w-10 min-h-10 w-10 h-10 rounded-full items-center justify-center",n?"bg-green-600":"bg-primary-600"),children:e.jsx(d,{icon:$})}),e.jsxs("div",{children:[e.jsx(m,{children:n?"Website Exclusive Story":"Restricted Story"}),e.jsx(w,{children:"Content locked"})]})]}),e.jsxs(b,{variant:n?"green":"gold",className:"flex flex-row gap-2 justify-center text-ssm",children:[e.jsx(d,{icon:W}),n?"Registration Required":`Tier "${E(o)?.name}"+`]}),e.jsxs(u,{shape:"square",size:"small",variant:n?"submit":"primary",onClick:()=>(r(!0),l(n?"/register":"/subscriptions")),children:[i?e.jsx(d,{icon:v,spin:!0}):e.jsx(d,{icon:n?K:Q,className:"mr-2"}),n?"Sign Up":"Upgrade to Unlock"]}),e.jsx("div",{className:"grow"}),e.jsx("div",{className:"flex flex-row justify-between",children:e.jsx("span",{className:"text-sm text-mono-500",children:P(a.createdAt)})})]})},_=a=>{switch(a){case"extreme":return 0;case"graphic":return 1;case"moderate":return 2;case"mild":return 3;default:return-1}},fe=({postId:a,queryId:i,warnings:r})=>{const l=r.sort((t,x)=>_(t.level)-_(x.level)),o=["post",i],{mutate:n,isPending:s}=q({mutationFn:J,onSuccess:async()=>{U.setQueryData(o,t=>{if(t)return{...t,userAgreement:!0}})}});return e.jsx("div",{className:"container mx-auto px-4 max-w-lg flex flex-col gap-4",children:e.jsxs(g,{className:"text-base flex flex-col gap-4",children:[e.jsx(m,{className:"text-2xl",children:"Content Warnings And Terms"}),e.jsx(w,{className:"text-base",children:"This story contains content that requires your acknowledgment before reading."}),e.jsx(m,{children:"This story contains:"}),e.jsx("div",{className:"flex flex-col gap-2",children:l.map((t,x)=>t.level==="extreme"||t.level==="graphic"?e.jsxs(b,{variant:"red",className:"text-base",children:[e.jsx(d,{icon:y}),t.text," (",N(t.level),")"]},x):t.level==="moderate"?e.jsxs(b,{variant:"gold",className:"text-base",children:[e.jsx(d,{icon:y}),t.text," (",N(t.level),")"]},x):e.jsxs(b,{variant:"gray",className:"text-base",children:[e.jsx(d,{icon:y}),t.text," (",N(t.level),")"]},x))}),e.jsxs(g,{className:"p-4 text-justify shadow-none text-sm/6 text-mono-600 dark:text-mono-400",children:[e.jsx("p",{children:"By proceeding, you acknowledge that this is a work of fiction."}),e.jsx("br",{}),e.jsx("p",{children:"The views expressed within are part of the story and do not represent the beliefs or opinions of the author. You agree to engage with this content responsibly and solely for the purpose of entertainment."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(u,{size:"small",shape:"square",variant:"outline",children:"I do not agree, Go Back"}),e.jsx(u,{disabled:s,size:"small",shape:"square",variant:"submit",onClick:()=>n(a),children:s?e.jsx(d,{icon:v,spin:!0}):"I Understand & Agree to Terms"})]})]})})},je=c.lazy(()=>k(()=>import("./Comments-x78SD8ih.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]))),be=c.lazy(()=>k(()=>import("./ReactionSection-4EO1IM8U.js"),__vite__mapDeps([23,1,2,3,4,5]))),ve=c.lazy(()=>k(()=>import("./Markdown-3h1heg92.js"),__vite__mapDeps([24,2,1,3,4,5,13,14,15,10,16,17,18,8,12,19,20,9,21,22]))),ye=()=>{const a=C(),{id:i}=ne(),{data:r=void 0,isError:l,isLoading:o}=ee({queryKey:["post",i],queryFn:()=>Z(de(i)),staleTime:1e3*60*5,enabled:!!i,retry:2});re(r?.title),oe("Post",{name:r?.title},!!r);const{mutate:n}=q({mutationFn:X});return c.useEffect(()=>{window.scrollTo(0,0);async function s(){r&&r.relatedPosts&&n(r.id)}s()},[r]),c.useEffect(()=>{async function s(){l&&(B(D.postNotFound,{id:i}),a("/404"))}s()},[l]),o?e.jsx(ce,{}):r===void 0?null:!r.userAgreement&&r.warnings&&r.warnings.length>0&&!r.userAgreement?e.jsx(fe,{warnings:r.warnings,postId:r.id,queryId:i}):e.jsxs("div",{className:"container mx-auto px-4 max-w-4xl flex flex-col gap-4",children:[e.jsxs(g,{className:"p-8 md:p-12 mt-4",children:[e.jsx(m,{className:"text-4xl md:text-5xl font-bold font-serif",children:r.title}),e.jsx("div",{className:"flex flex-wrap items-center gap-4 mt-3 mb-4",children:e.jsx(w,{className:"text-base text-primary-600 dark:text-primary-400 font-medium",children:P(r.createdAt)})}),r.tags&&r.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:r.tags.map(s=>e.jsxs(se,{children:["#",s.value]},s.value))}),e.jsx(c.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(be,{id:r.id})}),e.jsx(S,{}),e.jsx(c.Suspense,{fallback:e.jsxs("div",{className:"my-4 text-mono-700 dark:text-mono-300 leading-relaxed text-justify text-lg",children:[e.jsx("div",{className:"h-6 bg-mono-200 dark:bg-mono-700 rounded-3xl mb-3"}),e.jsx("div",{className:"h-6 bg-mono-200 dark:bg-mono-700 rounded-3xl mb-3"}),e.jsx("div",{className:"h-6 bg-mono-200 dark:bg-mono-700 rounded-3xl mb-3"}),e.jsx("div",{className:"h-6 bg-mono-200 dark:bg-mono-700 rounded-3xl mb-3"})]}),children:e.jsx(ve,{content:r.content,className:"mt-8"})})]}),e.jsx(te,{policy:L(F(),z("admin")),children:e.jsx(me,{post:r})}),r.references&&r.references.length>0&&e.jsx(xe,{references:r.references,className:"mt-4"}),r.relatedPosts&&r.relatedPosts.length>0&&e.jsxs("div",{className:p("flex flex-col gap-4"),children:[e.jsx(m,{children:"Related posts"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:r.relatedPosts&&r.relatedPosts.length>0&&r.relatedPosts.map(s=>s.title?e.jsx(ge,{relatedPost:s},s.id):e.jsx(he,{relatedPost:s},s.id))})]}),e.jsx(m,{className:"mt-4",children:"Comments"}),e.jsx(c.Suspense,{fallback:e.jsx(ue,{}),children:e.jsx(je,{postId:r.id})})]})},De=Object.freeze(Object.defineProperty({__proto__:null,default:ye},Symbol.toStringTag,{value:"Module"}));export{ue as C,le as M,De as P};
